<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponent Sniper - Type Only Version</title>
    <style>
        body { background: #05070a; color: #00ff41; font-family: 'Courier New', monospace; text-align: center; margin: 0; padding: 10px; }
        .game-wrapper { max-width: 600px; margin: 0 auto; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: flex; align-items: center; justify-content: center; z-index: 100; }
        .modal { background: #0f1510; border: 2px solid #00ff41; padding: 25px; border-radius: 10px; width: 85%; max-width: 350px; }
        .info-panel { background: #0f1510; border: 1px solid #00ff41; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ä‡πà‡∏≠‡∏á Input ‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô 100% */
        .input-group { margin: 20px 0; display: flex; align-items: center; justify-content: center; gap: 10px; }
        #user-exponent { 
            background: #000; 
            border: 2px solid #00ff41; 
            color: #ffff00; 
            padding: 15px; 
            width: 120px; 
            text-align: center; 
            font-size: 1.8rem; 
            outline: none;
            border-radius: 8px;
            /* ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î */
            -webkit-appearance: none;
            -moz-appearance: textfield;
            margin: 0;
        }
        #user-exponent:focus { box-shadow: 0 0 15px #00ff41; border-color: #fff; }
        
        button { background: #00ff41; color: #000; border: none; padding: 15px 30px; cursor: pointer; font-weight: bold; font-size: 1.2rem; border-radius: 5px; }
        button:hover { background: #fff; }
        button:disabled { background: #333; color: #666; cursor: not-allowed; }
        
        canvas { border: 1px solid #00ff41; background: #000; width: 100%; height: auto; max-width: 500px; margin-top: 15px; }
        #feedback { font-size: 1.3rem; font-weight: bold; margin: 10px 0; height: 1.5em; }
    </style>
</head>
<body>

<div class="game-wrapper">
    <!-- Login Screen -->
    <div id="login-screen" class="overlay">
        <div class="modal">
            <h2 style="margin-top:0">üéØ Sniper M.5</h2>
            <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</p>
            <input type="text" id="p-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" style="width:85%; padding:10px; margin-bottom:10px; background:#000; border:1px solid #00ff41; color:#00ff41;"><br>
            <input type="text" id="p-class" placeholder="‡∏ä‡∏±‡πâ‡∏ô" style="width:40%; padding:10px; background:#000; border:1px solid #00ff41; color:#00ff41;">
            <input type="text" id="p-no" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà" style="width:40%; padding:10px; background:#000; border:1px solid #00ff41; color:#00ff41;">
            <br><button onclick="startGame()" style="margin-top:20px; width:90%;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏™‡∏ô‡∏≤‡∏°‡∏£‡∏ö</button>
        </div>
    </div>

    <!-- Finish Screen -->
    <div id="finish-screen" class="overlay" style="display:none;">
        <div class="modal">
            <h2 style="color:#ffff00">üèÅ ‡∏à‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</h2>
            <div id="final-stats" style="margin-bottom:20px; line-height:1.6;"></div>
            <button onclick="location.reload()">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </div>
    </div>

    <div class="info-panel">
        <div id="player-display" style="font-size:0.9rem; color:#888; margin-bottom:5px;"></div>
        <div style="display:flex; justify-content:space-around; font-weight:bold; font-size:1.1rem; margin-bottom:10px;">
            <span>‡∏Ç‡πâ‡∏≠: <span id="round-count">1</span>/10</span>
            <span>Score: <span id="score-val" style="color:#ffff00">0</span></span>
        </div>
        <div style="font-size:1.4rem; border-top:1px dashed #333; padding-top:10px;">
            ‡∏™‡∏°‡∏Å‡∏≤‡∏£: <span id="target-y" style="color:#fff">?</span> = <span id="current-base" style="color:#fff">?</span><sup>x</sup>
        </div>
    </div>

    <div class="input-group">
        <span style="font-size:1.5rem">x = </span>
        <!-- ‡πÉ‡∏ä‡πâ type="text" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô Spinner ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ inputmode="decimal" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏õ‡πâ‡∏ô‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ -->
        <input type="text" id="user-exponent" inputmode="decimal" autocomplete="off" placeholder="?">
        <button id="fireBtn" onclick="fire()">FIRE!</button>
    </div>

    <div id="feedback">‡πÄ‡∏•‡πá‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏¢‡∏¥‡∏á!</div>
    <canvas id="graphCanvas" width="500" height="550"></canvas>
</div>

<script>
    const canvas = document.getElementById('graphCanvas');
    const ctx = canvas.getContext('2d');
    const inputEl = document.getElementById('user-exponent');
    const fireBtn = document.getElementById('fireBtn');
    const scale = 50;
    
    // ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const SCRIPT_URL = "‡πÉ‡∏™‡πà_WEB_APP_URL_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà";

    let base, targetX, targetY, lastUserX = null, score = 0, round = 1, isHit = false, isLock = false;
    let playerInfo = {};

    // ‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏¥‡∏á
    inputEl.addEventListener('keypress', (e) => { if(e.key === 'Enter') fire(); });

    function startGame() {
        playerInfo = {
            name: document.getElementById('p-name').value,
            class: document.getElementById('p-class').value,
            no: document.getElementById('p-no').value
        };
        if(!playerInfo.name || !playerInfo.class || !playerInfo.no) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á");
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('player-display').innerText = `üë§ SNIPER: ${playerInfo.name} (${playerInfo.class}) #${playerInfo.no}`;
        initRound();
    }

    function initRound() {
        if (round > 10) return finishGame();
        
        // Reset ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        isLock = false;
        isHit = false;
        lastUserX = null;
        
        // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ
        inputEl.value = '';
        inputEl.disabled = false;
        fireBtn.disabled = false;
        
        // ‡∏™‡∏∏‡πà‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå
        const basePool = [2, 3, 5, 0.5, 0.2];
        const exps = [-2, -1, 0, 1, 2];
        base = basePool[Math.floor(Math.random() * basePool.length)];
        targetX = exps[Math.floor(Math.random() * exps.length)];
        targetY = Math.pow(base, targetX);

        document.getElementById('round-count').innerText = round;
        document.getElementById('current-base').innerText = base;
        document.getElementById('target-y').innerText = Number(targetY.toFixed(3));
        document.getElementById('feedback').innerText = "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ x ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏¢‡∏¥‡∏á!";
        document.getElementById('feedback').style.color = "#00ff41";
        
        draw();
        
        // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå
        setTimeout(() => inputEl.focus(), 100);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cx = canvas.width/2, cy = canvas.height/2 + 100;
        
        // Grid lines
        ctx.strokeStyle = "#111"; ctx.lineWidth = 1;
        for(let i=-10; i<=10; i++) {
            ctx.beginPath(); ctx.moveTo(cx+i*scale, 0); ctx.lineTo(cx+i*scale, canvas.height); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(0, cy-i*scale); ctx.lineTo(canvas.width, cy-i*scale); ctx.stroke();
        }
        
        // Axes
        ctx.strokeStyle = "#444"; ctx.lineWidth = 2;
        ctx.beginPath(); ctx.moveTo(0, cy); ctx.lineTo(canvas.width, cy); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(cx, 0); ctx.lineTo(cx, canvas.height); ctx.stroke();

        // ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏â‡∏•‡∏¢
        if (lastUserX !== null) {
            ctx.strokeStyle = isHit ? "#fff" : "#ff4141";
            ctx.lineWidth = 4;
            ctx.beginPath();
            let first = true;
            for (let x = -8; x <= lastUserX; x += 0.1) {
                let py = cy - Math.pow(base, x) * scale;
                if (first) { ctx.moveTo(cx + x*scale, py); first = false; }
                else { ctx.lineTo(cx + x*scale, py); }
            }
            ctx.stroke();
        }

        // ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
        ctx.fillStyle = isHit ? "#fff" : "red";
        ctx.shadowBlur = 15; ctx.shadowColor = ctx.fillStyle;
        ctx.beginPath();
        ctx.arc(cx + targetX*scale, cy - targetY*scale, isHit?15:10, 0, Math.PI*2);
        ctx.fill();
        ctx.shadowBlur = 0;
    }

    function fire() {
        const val = inputEl.value.trim();
        if (val === "" || isLock) return;
        
        isLock = true;
        let userAns = parseFloat(val);
        lastUserX = userAns;
        
        inputEl.disabled = true;
        fireBtn.disabled = true;

        if (Math.abs(userAns - targetX) < 0.01) {
            isHit = true;
            score += 10;
            document.getElementById('feedback').innerText = "üéØ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏¢‡∏¥‡∏á‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡πâ‡∏≤";
            document.getElementById('feedback').style.color = "#00ff41";
        } else {
            score = 0; // ‡∏ú‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß Reset ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤
            document.getElementById('feedback').innerText = `‚ùå ‡∏û‡∏•‡∏≤‡∏î! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ x = ${targetX}`;
            document.getElementById('feedback').style.color = "#ff4141";
        }

        document.getElementById('score-val').innerText = score;
        draw();
        
        round++;
        setTimeout(initRound, 2000);
    }

    function finishGame() {
        document.getElementById('finish-screen').style.display = 'flex';
        document.getElementById('final-stats').innerHTML = `<b>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô:</b> ${playerInfo.name}<br><b>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</b> ${score} ‡πÅ‡∏ï‡πâ‡∏°`;
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£ fetch ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö
    }
</script>

</body>
</html>
